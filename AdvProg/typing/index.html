<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AIお題でタイピング練習</title>
    <link rel="stylesheet" href="./style.css" />
  </head>
  <body>
    <main class="app">
      <header class="app__header">
        <h1>AIお題でタイピング練習</h1>
        <p class="app__sub">短文〜中編のお題を出題。WPM・正確性をリアルタイム計測します。</p>
      </header>

      <section class="card">
        <div class="controls">
          <div class="controls__row">
            <label class="switch">
              <input id="useAI" type="checkbox" />
              <span class="slider"></span>
            </label>
            <span>AIでお題を生成する</span>
          </div>

          <div id="aiSettings" class="controls__grid hidden">
            <label class="field">
              <span>APIエンドポイント</span>
              <input id="apiEndpoint" type="text" placeholder="https://api.openai.com/v1/responses" />
            </label>
            <label class="field">
              <span>モデル名</span>
              <input id="modelName" type="text" placeholder="gpt-4o-mini" />
            </label>
            <label class="field">
              <span>APIキー</span>
              <input id="apiKey" type="password" placeholder="sk-..." />
            </label>
          </div>

          <div class="controls__row gap">
            <button id="btnNew" class="btn">新しいお題</button>
            <button id="btnStart" class="btn btn--primary">スタート</button>
            <button id="btnReset" class="btn btn--ghost">リセット</button>
          </div>
        </div>

        <div class="prompt">
          <div class="prompt__label">お題</div>
          <div id="promptText" class="prompt__text" aria-live="polite"></div>
          <div class="progress">
            <div id="progressBar" class="progress__bar" style="width:0%"></div>
          </div>
        </div>

        <div class="typing">
          <textarea
            id="typingArea"
            class="typing__area"
            placeholder="スタートするとここに入力できます"
            disabled
            aria-label="タイピング入力欄"
          ></textarea>
        </div>

        <div class="stats">
          <div class="stat">
            <div class="stat__label">WPM</div>
            <div id="statWpm" class="stat__value">0.0</div>
          </div>
          <div class="stat">
            <div class="stat__label">正確性</div>
            <div id="statAcc" class="stat__value">100%</div>
          </div>
          <div class="stat">
            <div class="stat__label">経過時間</div>
            <div id="statTime" class="stat__value">00:00</div>
          </div>
          <div class="stat">
            <div class="stat__label">ミス</div>
            <div id="statErrors" class="stat__value">0</div>
          </div>
        </div>
      </section>

      <section class="card card--muted">
        <details>
          <summary>使い方と注意点</summary>
          <ul>
            <li>「AIでお題を生成する」をONにすると、API設定欄が出ます。</li>
            <li>エンドポイント未入力時は <code>https://api.openai.com/v1/responses</code> を試行し、失敗時はローカル生成に自動フォールバックします。</li>
            <li>APIキーはブラウザに保存されません。公開環境ではサーバープロキシ経由を推奨します。</li>
          </ul>
        </details>
      </section>

      <footer class="app__footer">
        <small>© 2025 Typing Practice</small>
      </footer>
    </main>

    <script src="./script.js" defer></script>
  </body>
</html>
